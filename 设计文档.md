# 网页版飞机大战游戏设计文档

## 1. 技术栈

- **前端框架**：HTML5 + CSS3 + JavaScript (原生)
- **游戏引擎**：Canvas API
- **开发工具**：任何文本编辑器
- **浏览器兼容性**：支持Chrome、Firefox、Safari、Edge等现代浏览器

## 2. 游戏架构

### 2.1 整体架构

```
GameEngine
├── GameController
├── Renderer
├── InputHandler
├── CollisionDetector
├── EntityManager
└── SoundManager
```

### 2.2 核心类设计

#### 2.2.1 GameController
- **职责**：游戏主控制器，负责游戏的初始化、更新和结束
- **主要方法**：
  - `init()`：初始化游戏
  - `start()`：开始游戏
  - `update()`：更新游戏状态
  - `end()`：结束游戏
  - `reset()`：重置游戏

#### 2.2.2 Renderer
- **职责**：负责游戏画面的渲染
- **主要方法**：
  - `init(canvas)`：初始化渲染器
  - `clear()`：清空画布
  - `render(entity)`：渲染单个实体
  - `renderAll()`：渲染所有实体
  - `renderUI()`：渲染游戏界面

#### 2.2.3 InputHandler
- **职责**：处理玩家输入
- **主要方法**：
  - `init()`：初始化输入处理
  - `isKeyPressed(key)`：检查按键是否被按下

#### 2.2.4 CollisionDetector
- **职责**：检测实体间的碰撞
- **主要方法**：
  - `checkCollision(entity1, entity2)`：检查两个实体是否碰撞
  - `checkAllCollisions()`：检查所有实体间的碰撞

#### 2.2.5 EntityManager
- **职责**：管理游戏中的所有实体
- **主要方法**：
  - `addEntity(entity)`：添加实体
  - `removeEntity(entity)`：移除实体
  - `getEntitiesByType(type)`：按类型获取实体
  - `updateAll()`：更新所有实体

#### 2.2.6 SoundManager
- **职责**：管理游戏音效
- **主要方法**：
  - `playSound(sound)`：播放音效
  - `stopSound(sound)`：停止音效
  - `setVolume(volume)`：设置音量

### 2.3 游戏实体类

#### 2.3.1 Entity（基类）
- **属性**：
  - `x`：x坐标
  - `y`：y坐标
  - `width`：宽度
  - `height`：高度
  - `speed`：速度
  - `health`：生命值
  - `type`：实体类型
- **方法**：
  - `update()`：更新实体状态
  - `render()`：渲染实体
  - `destroy()`：销毁实体

#### 2.3.2 Player（玩家飞机）
- **继承**：Entity
- **属性**：
  - `bulletType`：当前子弹类型
  - `fireRate`：射击频率
  - `lastShotTime`：上次射击时间
- **方法**：
  - `move(direction)`：移动飞机
  - `shoot()`：射击
  - `collectPowerUp(powerUp)`：收集奖励

#### 2.3.3 Bullet（子弹）
- **继承**：Entity
- **属性**：
  - `damage`：伤害值
  - `target`：目标（跟踪弹使用）
  - `bulletType`：子弹类型
- **方法**：
  - `update()`：更新子弹位置和状态

#### 2.3.4 Enemy（怪物）
- **继承**：Entity
- **属性**：
  - `enemyType`：怪物类型
  - `movePattern`：移动模式
  - `dropRate`：掉落奖励概率
- **方法**：
  - `update()`：更新怪物位置和状态
  - `dropPowerUp()`：掉落奖励

#### 2.3.5 PowerUp（奖励）
- **继承**：Entity
- **属性**：
  - `powerUpType`：奖励类型
  - `duration`：效果持续时间
- **方法**：
  - `update()`：更新奖励位置
  - `applyEffect(player)`：应用奖励效果

## 3. 游戏流程

### 3.1 游戏初始化
1. 加载游戏资源
2. 初始化游戏控制器
3. 初始化画布和渲染器
4. 初始化输入处理
5. 显示游戏主菜单

### 3.2 游戏运行
1. 玩家点击开始按钮
2. 初始化玩家飞机
3. 开始生成怪物
4. 玩家控制飞机移动，自动射击
5. 检测碰撞
6. 更新分数和游戏状态
7. 生成奖励
8. 玩家收集奖励，切换子弹类型

### 3.3 游戏结束
1. 玩家飞机生命值耗尽或被怪物撞击
2. 停止生成怪物
3. 显示游戏结束界面
4. 显示最终得分
5. 提供重新开始和返回主菜单选项

## 4. 核心功能实现

### 4.1 玩家控制
- 使用WASD键控制飞机移动
- 通过键盘事件监听实现
- 限制飞机移动范围，防止超出画布

### 4.2 自动射击
- 玩家飞机按照固定频率自动发射子弹
- 不同子弹类型有不同的射击效果
- 子弹从飞机前端发射

### 4.3 怪物系统
- **类型1**：小型怪物，血量低，移动快，掉落概率低
- **类型2**：中型怪物，血量中等，移动中等，掉落概率中等
- **类型3**：大型怪物，血量高，移动慢，掉落概率高
- 怪物从屏幕顶部随机位置生成
- 不同怪物有不同的移动轨迹

### 4.4 奖励机制
- **奖励1**：散弹 - 一次发射5发子弹，呈扇形分布
- **奖励2**：跟踪弹 - 自动追踪最近的怪物
- **奖励3**：激光 - 高伤害的直线光束，贯穿效果
- 怪物被消灭后有概率掉落奖励
- 奖励从屏幕顶部掉落，玩家接触后获得效果

### 4.5 碰撞检测
- 使用矩形碰撞检测算法
- 检测子弹与怪物的碰撞
- 检测玩家与怪物的碰撞
- 检测玩家与奖励的碰撞

## 5. 视觉设计

### 5.1 颜色方案
- **背景色**：深蓝色渐变
- **玩家飞机**：蓝色和白色
- **子弹**：
  - 基础子弹：白色
  - 散弹：黄色
  - 跟踪弹：紫色
  - 激光：红色
- **怪物**：
  - 类型1：绿色
  - 类型2：橙色
  - 类型3：红色
- **奖励**：
  - 散弹：黄色
  - 跟踪弹：紫色
  - 激光：红色

### 5.2 动画效果
- 玩家飞机：轻微的上下浮动动画
- 子弹：发射时有粒子效果
- 怪物：不同的移动动画
- 爆炸效果：怪物被消灭时的爆炸动画
- 奖励：旋转动画

### 5.3 字体设计
- 游戏标题：大号粗体字体
- 分数和生命值：清晰易读的字体
- 按钮文字：中等大小，醒目的颜色

## 6. 性能优化

- 使用requestAnimationFrame进行动画更新
- 实现对象池，复用子弹和怪物对象
- 只渲染屏幕内的实体
- 优化碰撞检测算法
- 合理使用Canvas的绘制方法

## 7. 扩展性设计

- 模块化的代码结构，便于添加新功能
- 实体类的继承设计，便于添加新的怪物和子弹类型
- 配置化的游戏参数，便于调整游戏难度
- 清晰的API设计，便于扩展游戏功能

## 8. 测试计划

### 8.1 单元测试
- 测试各个类的功能是否正常
- 测试碰撞检测算法的准确性
- 测试输入处理的响应性

### 8.2 集成测试
- 测试游戏整体流程是否正常
- 测试各个系统之间的交互是否正常

### 8.3 性能测试
- 测试游戏在不同设备上的运行流畅度
- 测试游戏在大量实体时的性能表现

### 8.4 兼容性测试
- 测试游戏在不同浏览器上的表现
- 测试游戏在不同屏幕尺寸上的适配情况